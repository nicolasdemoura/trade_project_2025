# Trade Project 1: Estimating Trump's Tariff Impact on Global Welfare

## Project Overview

This project implements the **Costinot, Donaldson, and Komunjer (2012) multi-sector Ricardian model** using WIOD 2011 Input-Output tables to analyze the economic impact of Trump's proposed tariffs on global welfare.

## Methodology: CDK (2012) Multi-Sector Ricardian Model

**Exact implementation of Costinot, Donaldson, and Komunjer (2012)**:

### Model Structure
- **Multi-sector Ricardian framework** with sector-specific productivities
- **Labor mobility** across sectors within countries (only factor of production)  
- **Sector-specific trade elasticities** θₛ
- **Cobb-Douglas preferences** with expenditure shares βₛ

### Key Equations
- **Trade shares**: π_{ijs} = T_{is}(τ_{ijs}w_i)^{-θₛ} / (P_{js})^{-θₛ}
- **Price indices**: P_{js} = [∑_i T_{is}(τ_{ijs}w_i)^{-θₛ}]^{-1/θₛ}
- **Welfare**: W_j = w_j / ∏_s (P_{js})^{βₛ}

### Estimation (CDK Section 5.1)
- **Reduced-form regression**: ln(π_{ijs}) = δ_{is} + δ_{js} + ε_{ijs}
- **Origin-sector fixed effects** capture ln(T_{is}) - θₛ ln(w_i)
- **Destination-sector fixed effects** capture θₛ ln(P_{js})
- **Trade elasticities** from CDK (2012) Table 3 estimates

## Data Sources

- **WIOD 2011 Input-Output Tables** (`wiot_full.dta`): Bilateral trade flows and sectoral outputs
- **WIOD Socio-Economic Accounts** (`Socio_Economic_Accounts_July14.xlsx`): Labor inputs and employment data

## File Structure

### Core Analysis Files

- `main.R` - Main analysis script that runs the complete workflow
- `functions.R` - Core Eaton-Kortum model functions
- `data_cleaning.R` - Data preparation and cleaning functions  
- `estimation.R` - Parameter estimation (CDK 2012 approach)
- `counterfactual.R` - Trump tariff scenarios and welfare analysis

### Utility Files

- `explore_data.R` - Data structure exploration script
- `run_exploration.R` - Quick script to run data exploration

## Trump Tariff Scenario

Based on 2024 campaign proposals:
- 10-20% universal tariff on all US imports (using 15% average)
- 60% tariff on Chinese imports to US
- Additional robustness scenarios: moderate, aggressive, targeted

## Key Functions

### CDK Model Functions (`functions.R`)
- `calculate_trade_share_cdk()` - CDK multi-sector trade shares
- `calculate_price_index_cdk()` - Sector-specific price indices  
- `solve_equilibrium_cdk()` - Multi-sector equilibrium solver
- `calculate_welfare_cdk()` - Cobb-Douglas welfare calculation

### CDK Estimation Functions (`estimation.R`)
- `prepare_cdk_regression_data()` - Format data for CDK Section 5.1
- `estimate_cdk_technology_params()` - Fixed effects regression
- `calibrate_cdk_baseline()` - Calibrate baseline equilibrium
- `check_model_fit()` - Validate against observed trade patterns

### CDK Counterfactual Functions (`counterfactual.R`)  
- `create_trump_tariff_scenario_cdk()` - Multi-sector tariff matrices
- `compute_counterfactual_equilibrium_cdk()` - Solve counterfactual
- `analyze_welfare_effects_cdk()` - Decompose welfare changes

## Usage

### Quick Start

1. **Explore Data Structure**:
```r
source("code/run_exploration.R")
```

2. **Run Full Analysis**:
```r
source("code/main.R")
```

### Step-by-Step Workflow

```r
# Load functions
source("code/functions.R")
source("code/data_cleaning.R")
source("code/estimation.R")
source("code/counterfactual.R")

# Clean data
cleaned_data <- clean_all_data(wiot_full, socioeco)

# Estimate parameters
theta <- estimate_trade_elasticity(NULL)
tech_params <- estimate_technology_params(regression_data, theta)

# Calibrate baseline
baseline <- calibrate_baseline_equilibrium(trade_shares, T_matrix, labor_data, theta)

# Run counterfactual
trump_tariffs <- create_trump_tariff_scenario(countries, sectors)
counterfactual <- compute_counterfactual_equilibrium(baseline, trump_tariffs, theta)

# Analyze welfare
welfare_results <- analyze_welfare_effects(baseline, counterfactual, countries)
```

## Output

### Tables (saved to `Tables/` directory)
- `trump_tariff_results.xlsx` - Main results with baseline and counterfactual welfare
- `welfare_analysis.xlsx` - Detailed welfare decomposition by country
- `scenario_comparison.xlsx` - Robustness across different tariff scenarios

### Key Results
- Global welfare change under Trump tariffs
- Country-specific welfare impacts (winners vs losers)
- Decomposition into wage and price effects
- Model fit diagnostics (correlation with observed GDP per capita)

## Model Validation

The model includes diagnostic checks:
- Trade share correlation between model and data
- GDP per capita correlation (real income vs observed GDP)
- Trade balance validation
- Parameter reasonableness checks

## Dependencies

Required R packages:
```r
install.packages(c("dplyr", "ggplot2", "stargazer", "readxl", "tidyverse", 
                   "data.table", "lubridate", "fixest", "pracma", "remotes", 
                   "tidyr", "nprobust", "chron", "haven", "readr", "writexl", 
                   "modelsummary", "lmtest", "progress"))
```

## Notes

- The project assumes labor is the only factor of production and is mobile across sectors
- Trade costs are backed out endogenously from observed trade patterns
- Multiple tariff scenarios provide robustness checks
- Results should be interpreted as partial equilibrium effects within the EK framework

## References

- Costinot, A., Donaldson, D., & Komunjer, I. (2012). What goods do countries trade? A quantitative exploration of Ricardo's ideas. *Review of Economic Studies*, 79(2), 581-608.
- Eaton, J., & Kortum, S. (2002). Technology, geography, and trade. *Econometrica*, 70(5), 1741-1779.

## Contact

Nícolas de Moura  
Email: nicolasgoulartdemoura@gmail.com  
Date: October 1, 2025